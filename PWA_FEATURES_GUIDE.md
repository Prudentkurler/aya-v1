# PWA & Offline Features Guide

## üöÄ Progressive Web App (PWA) Features

Your Me Apomuden health app is now a fully installable Progressive Web App with offline capabilities!

### ‚ú® Key Features

1. **Installable App**
   - Install directly from your browser to home screen
   - Works like a native app on Android, iOS, and Desktop
   - No app store required!

2. **Offline-First Architecture**
   - All data stored locally using IndexedDB (Dexie.js)
   - Continue tracking health measurements without internet
   - Automatic sync when connection is restored

3. **Toast Notifications**
   - Health alerts appear as toast notifications
   - Critical, warning, and info alerts
   - Dismissible with action buttons

4. **Service Worker Caching**
   - App shell cached for instant loading
   - Works completely offline after first visit
   - Smart cache strategy for assets and API calls

## üì± How to Install the PWA

### On Android (Chrome/Edge)
1. Open the app in Chrome or Edge
2. Tap the menu (‚ãÆ) ‚Üí "Install app" or "Add to Home screen"
3. Or look for the install prompt banner at the bottom of the screen
4. Tap "Install" and the app will be added to your home screen

### On iOS (Safari)
1. Open the app in Safari
2. Tap the Share button (‚ñ°‚Üë)
3. Scroll down and tap "Add to Home Screen"
4. Name it "Me Apomuden" and tap "Add"

### On Desktop (Chrome/Edge)
1. Open the app in Chrome or Edge
2. Look for the install icon (‚äï) in the address bar
3. Click it and select "Install"
4. Or check for the install prompt at the bottom of the page

## üß™ Testing Offline Functionality

### Method 1: Browser DevTools
1. Open the app in your browser
2. Open DevTools (F12)
3. Go to the "Network" tab
4. Check "Offline" checkbox
5. Try navigating and using the app - it should work!

### Method 2: Chrome DevTools Application Tab
1. Open DevTools (F12)
2. Go to "Application" tab
3. Click "Service Workers" in the left sidebar
4. Check "Offline" checkbox
5. Verify the service worker is active and controlling the page

### Method 3: Test with Real Network Disconnect
1. Install the PWA to your device
2. Disconnect from WiFi and mobile data
3. Open the installed app
4. Verify you can:
   - View existing measurements
   - Add new BP/glucose readings
   - View medications
   - Browse all pages

## üîî Health Alerts & Notifications

The app monitors your health data and shows toast notifications for:

- **Critical Alerts** (Red) - Immediate attention needed
  - Very high blood pressure readings
  - Dangerous glucose levels
  - Multiple missed medication doses

- **Warning Alerts** (Yellow) - Should be addressed soon
  - Elevated BP or glucose readings
  - Some missed medications
  - Unusual health trends

- **Info Alerts** (Blue) - Helpful reminders
  - Upcoming CHW visits
  - Medication reminders
  - General health tips

### Alert Features
- Appear as toast notifications in the top-right corner
- Auto-dismiss after 5-10 seconds (or stay for critical alerts)
- Click "Dismiss" to remove permanently
- Stored in local database
- Will re-appear if not dismissed

## üé¨ Demo Data for Video

### Quick Setup
1. Go to `/admin` page
2. Click "Seed Demo Data" button
3. Wait for success toast
4. Refresh the page
5. You now have:
   - 3 demo patients with realistic Ghanaian names
   - 7 health measurements (BP and glucose)
   - 3 medications with prescriptions
   - 2 CHW home visits with vitals
   - 2 ePrescriptions from clinicians
   - 2 referrals to health facilities
   - 3 health alerts (critical, warning, info)

### Demo Walkthrough
1. **Patient Dashboard** - View overview with stats
2. **Measurements** - See BP/glucose trends
3. **Add Measurement** - Demo the inline tabs (BP/Glucose)
4. **Medications** - View active prescriptions
5. **CHW Dashboard** - Show patient visits and referrals
6. **Clinician Portal** - View prescriptions and alerts
7. **Offline Mode** - Turn off network and demo offline functionality

## üõ†Ô∏è Technical Details

### PWA Configuration
- **Manifest**: `/public/manifest.json`
- **Service Worker**: Auto-generated by `next-pwa`
- **Icons**: 192x192 and 512x512 PNG icons
- **Theme Color**: #0070C0 (Blue)
- **Display Mode**: Standalone (full-screen app experience)

### Offline Storage
- **IndexedDB** via Dexie.js
- **Tables**:
  - `measurements` - BP and glucose readings
  - `medications` - Medication list
  - `medicationAdherence` - Adherence tracking
  - `userProfile` - Patient information
  - `chwVisits` - Community health worker visits
  - `eprescriptions` - Electronic prescriptions
  - `referrals` - Facility referrals
  - `healthAlerts` - Health notifications
  - `syncQueue` - Pending sync operations

### Sync Strategy
- Offline-first: All writes go to local DB immediately
- Background sync when online
- Conflict resolution for concurrent edits
- Retry queue for failed syncs

## üìä Browser Compatibility

- ‚úÖ Chrome/Edge (Android, Desktop) - Full support
- ‚úÖ Safari (iOS, macOS) - Full support (with manual install)
- ‚úÖ Firefox (Android, Desktop) - Full support
- ‚ö†Ô∏è Samsung Internet - Supported
- ‚ö†Ô∏è Opera - Supported

## üîê Privacy & Security

- All data stored locally on your device
- No data sent to servers without explicit sync
- Can export/clear all data from Admin page
- HTTPS required for service worker (production)

## üÜò Troubleshooting

### Install Prompt Not Showing?
- Make sure you're on HTTPS (or localhost)
- Clear browser cache and reload
- Check if you dismissed it recently (7-day cooldown)
- Try visiting the site from a fresh incognito window

### Service Worker Issues?
- Unregister old service workers in DevTools
- Clear site data and reload
- Check console for service worker errors

### Offline Not Working?
- Verify service worker is installed (check DevTools > Application)
- Make sure you visited the site at least once while online
- Check that IndexedDB is not disabled in browser settings

### Data Not Syncing?
- Check sync queue in Admin/Demo tools
- Verify network connection
- Look for errors in browser console

## üéØ Next Steps

1. **Test the Install** - Install the PWA on your device
2. **Try Offline** - Disconnect and verify functionality  
3. **Seed Demo Data** - Use Admin page to populate test data
4. **Record Video** - Show all features working smoothly
5. **Deploy** - Host on Vercel/Netlify for HTTPS and PWA features

---

**Made with ‚ù§Ô∏è for Ghana's healthcare system**
